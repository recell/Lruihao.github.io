(function e(u,f){if(typeof exports==="object"&&typeof module==="object")module.exports=f();else if(typeof define==="function"&&define.amd)define("pangu",[],f);else if(typeof exports==="object")exports["pangu"]=f();else u["pangu"]=f()})(this,function(){return function(e){var u={};function f(a){if(u[a])return u[a].exports;var t=u[a]={exports:{},id:a,loaded:false};e[a].call(t.exports,t,t.exports,f);t.loaded=true;return t.exports}f.m=e;f.c=u;f.p="";return f(0)}([function(e,u,f){"use strict";var a=function(){function e(e,u){for(var f=0;f<u.length;f++){var a=u[f];a.enumerable=a.enumerable||false;a.configurable=true;if("value"in a)a.writable=true;Object.defineProperty(e,a.key,a)}}return function(u,f,a){if(f)e(u.prototype,f);if(a)e(u,a);return u}}();function t(e,u){if(!(e instanceof u)){throw new TypeError("Cannot call a class as a function")}}function n(e,u){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return u&&(typeof u==="object"||typeof u==="function")?u:e}function r(e,u){if(typeof u!=="function"&&u!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof u)}e.prototype=Object.create(u&&u.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(u)Object.setPrototypeOf?Object.setPrototypeOf(e,u):e.__proto__=u}var i=f(1).Pangu;var o=8;var s=function(e){r(u,e);function u(){t(this,u);var e=n(this,Object.getPrototypeOf(u).call(this));e.topTags=/^(html|head|body|#document)$/i;e.ignoreTags=/^(script|code|pre|textarea)$/i;e.spaceSensitiveTags=/^(a|del|pre|s|strike|u)$/i;e.spaceLikeTags=/^(br|hr|i|img|pangu)$/i;e.blockTags=/^(div|h1|h2|h3|h4|h5|h6|p)$/i;return e}a(u,[{key:"canIgnoreNode",value:function e(u){var f=u.parentNode;while(f&&f.nodeName&&f.nodeName.search(this.topTags)===-1){if(f.nodeName.search(this.ignoreTags)>=0||f.isContentEditable||f.getAttribute("g_editable")==="true"){return true}f=f.parentNode}return false}},{key:"isFirstTextChild",value:function e(u,f){var a=u.childNodes;for(var t=0;t<a.length;t++){var n=a[t];if(n.nodeType!==o&&n.textContent){return n===f}}return false}},{key:"isLastTextChild",value:function e(u,f){var a=u.childNodes;for(var t=a.length-1;t>-1;t--){var n=a[t];if(n.nodeType!==o&&n.textContent){return n===f}}return false}},{key:"spacingNodeByXPath",value:function e(u,f){var a=document.evaluate(u,f,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);var t=void 0;var n=void 0;for(var r=a.snapshotLength-1;r>-1;--r){t=a.snapshotItem(r);if(this.canIgnoreNode(t)){n=t;continue}var i=this.spacing(t.data);if(t.data!==i){t.data=i}if(n){if(t.nextSibling&&t.nextSibling.nodeName.search(this.spaceLikeTags)>=0){n=t;continue}var o=t.data.toString().substr(-1)+n.data.toString().substr(0,1);var s=this.spacing(o);if(s!==o){var c=n;while(c.parentNode&&c.nodeName.search(this.spaceSensitiveTags)===-1&&this.isFirstTextChild(c.parentNode,c)){c=c.parentNode}var d=t;while(d.parentNode&&d.nodeName.search(this.spaceSensitiveTags)===-1&&this.isLastTextChild(d.parentNode,d)){d=d.parentNode}if(d.nextSibling){if(d.nextSibling.nodeName.search(this.spaceLikeTags)>=0){n=t;continue}}if(d.nodeName.search(this.blockTags)===-1){if(c.nodeName.search(this.spaceSensitiveTags)===-1){if(c.nodeName.search(this.ignoreTags)===-1&&c.nodeName.search(this.blockTags)===-1){if(n.previousSibling){if(n.previousSibling.nodeName.search(this.spaceLikeTags)===-1){n.data=" "+n.data}}else{if(!this.canIgnoreNode(n)){n.data=" "+n.data}}}}else if(d.nodeName.search(this.spaceSensitiveTags)===-1){t.data=t.data+" "}else{var l=document.createElement("pangu");l.innerHTML=" ";if(c.previousSibling){if(c.previousSibling.nodeName.search(this.spaceLikeTags)===-1){c.parentNode.insertBefore(l,c)}}else{c.parentNode.insertBefore(l,c)}if(!l.previousElementSibling){if(l.parentNode){l.parentNode.removeChild(l)}}}}}}n=t}}},{key:"spacingNode",value:function e(u){var f=".//*/text()[normalize-space(.)]";this.spacingNodeByXPath(f,u)}},{key:"spacingElementById",value:function e(u){var f='id("'+u+'")//text()';this.spacingNodeByXPath(f,document)}},{key:"spacingElementByClassName",value:function e(u){var f='//*[contains(concat(" ", normalize-space(@class), " "), "'+u+'")]//text()';this.spacingNodeByXPath(f,document)}},{key:"spacingElementByTagName",value:function e(u){var f="//"+u+"//text()";this.spacingNodeByXPath(f,document)}},{key:"spacingPageTitle",value:function e(){var u="/html/head/title/text()";this.spacingNodeByXPath(u,document)}},{key:"spacingPageBody",value:function e(){var u="/html/body//*/text()[normalize-space(.)]";var f=["script","style","textarea"];for(var a=0;a<f.length;a++){var t=f[a];u+='[translate(name(..),"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")!="'+t+'"]'}this.spacingNodeByXPath(u,document)}},{key:"spacingPage",value:function e(){this.spacingPageTitle();this.spacingPageBody()}}]);return u}(i);var c=new s;u=e.exports=c;u.Pangu=s},function(e,u){"use strict";var f=function(){function e(e,u){for(var f=0;f<u.length;f++){var a=u[f];a.enumerable=a.enumerable||false;a.configurable=true;if("value"in a)a.writable=true;Object.defineProperty(e,a.key,a)}}return function(u,f,a){if(f)e(u.prototype,f);if(a)e(u,a);return u}}();function a(e,u){if(!(e instanceof u)){throw new TypeError("Cannot call a class as a function")}}var t=/([\u2e80-\u2eff\u2f00-\u2fdf\u3040-\u309f\u30a0-\u30ff\u3100-\u312f\u3200-\u32ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff])(["])/g;var n=/(["])([\u2e80-\u2eff\u2f00-\u2fdf\u3040-\u309f\u30a0-\u30ff\u3100-\u312f\u3200-\u32ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff])/g;var r=/(["']+)(\s*)(.+?)(\s*)(["']+)/g;var i=/([\u2e80-\u2eff\u2f00-\u2fdf\u3040-\u309f\u30a0-\u30ff\u3100-\u312f\u3200-\u32ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff])( )(')([A-Za-z])/g;var o=/([\u2e80-\u2eff\u2f00-\u2fdf\u3040-\u309f\u30a0-\u30ff\u3100-\u312f\u3200-\u32ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff])(#)([A-Za-z0-9\u2e80-\u2eff\u2f00-\u2fdf\u3040-\u309f\u30a0-\u30ff\u3100-\u312f\u3200-\u32ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff]+)(#)([\u2e80-\u2eff\u2f00-\u2fdf\u3040-\u309f\u30a0-\u30ff\u3100-\u312f\u3200-\u32ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff])/g;var s=/([\u2e80-\u2eff\u2f00-\u2fdf\u3040-\u309f\u30a0-\u30ff\u3100-\u312f\u3200-\u32ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff])(#([^ ]))/g;var c=/(([^ ])#)([\u2e80-\u2eff\u2f00-\u2fdf\u3040-\u309f\u30a0-\u30ff\u3100-\u312f\u3200-\u32ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff])/g;var d=/([\u2e80-\u2eff\u2f00-\u2fdf\u3040-\u309f\u30a0-\u30ff\u3100-\u312f\u3200-\u32ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff])([\+\-\*\/=&\\|<>])([A-Za-z0-9])/g;var l=/([A-Za-z0-9])([\+\-\*\/=&\\|<>])([\u2e80-\u2eff\u2f00-\u2fdf\u3040-\u309f\u30a0-\u30ff\u3100-\u312f\u3200-\u32ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff])/g;var p=/([\u2e80-\u2eff\u2f00-\u2fdf\u3040-\u309f\u30a0-\u30ff\u3100-\u312f\u3200-\u32ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff])([\(\[\{<\u201c]+(.*?)[\)\]\}>\u201d]+)([\u2e80-\u2eff\u2f00-\u2fdf\u3040-\u309f\u30a0-\u30ff\u3100-\u312f\u3200-\u32ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff])/g;var g=/([\u2e80-\u2eff\u2f00-\u2fdf\u3040-\u309f\u30a0-\u30ff\u3100-\u312f\u3200-\u32ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff])([\(\[\{<\u201c>])/g;var h=/([\)\]\}>\u201d<])([\u2e80-\u2eff\u2f00-\u2fdf\u3040-\u309f\u30a0-\u30ff\u3100-\u312f\u3200-\u32ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff])/g;var v=/([\(\[\{<\u201c]+)(\s*)(.+?)(\s*)([\)\]\}>\u201d]+)/;var b=/([\u2e80-\u2eff\u2f00-\u2fdf\u3040-\u309f\u30a0-\u30ff\u3100-\u312f\u3200-\u32ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff])([~!;:,\.\?\u2026])([A-Za-z0-9])/g;var y=/([\u2e80-\u2eff\u2f00-\u2fdf\u3040-\u309f\u30a0-\u30ff\u3100-\u312f\u3200-\u32ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff])([A-Za-z0-9`\$%\^&\*\-=\+\\\|/@\u00a1-\u00ff\u2022\u2027\u2150-\u218f])/g;var m=/([A-Za-z0-9`~\$%\^&\*\-=\+\\\|/!;:,\.\?\u00a1-\u00ff\u2022\u2026\u2027\u2150-\u218f])([\u2e80-\u2eff\u2f00-\u2fdf\u3040-\u309f\u30a0-\u30ff\u3100-\u312f\u3200-\u32ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff])/g;var $=function(){function e(){a(this,e)}f(e,[{key:"spacing",value:function e(u){var f=u;f=f.replace(t,"$1 $2");f=f.replace(n,"$1 $2");f=f.replace(r,"$1$3$5");f=f.replace(i,"$1$3$4");f=f.replace(o,"$1 $2$3$4 $5");f=f.replace(s,"$1 $2");f=f.replace(c,"$1 $3");f=f.replace(d,"$1 $2 $3");f=f.replace(l,"$1 $2 $3");var a=f;var $=f.replace(p,"$1 $2 $4");f=$;if(a===$){f=f.replace(g,"$1 $2");f=f.replace(h,"$1 $2")}f=f.replace(v,"$1$3$5");f=f.replace(b,"$1$2 $3");f=f.replace(y,"$1 $2");f=f.replace(m,"$1 $2");return f}},{key:"spacingText",value:function e(u){var f=arguments.length<=1||arguments[1]===undefined?function(){}:arguments[1];try{var a=this.spacing(u);f(null,a)}catch(e){f(e)}}}]);return e}();var N=new $;u=e.exports=N;u.Pangu=$}])});